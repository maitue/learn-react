!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SVGInjector={})}(this,(function(e){"use strict";var t=function(e){return e.cloneNode(!0)},r=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,n=/\\([\u000b\u0020-\u00ff])/g,i=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,o=function(e){if(!e)throw new TypeError("argument string is required");var t="object"==typeof e?function(e){var t;"function"==typeof e.getHeader?t=e.getHeader("content-type"):"object"==typeof e.headers&&(t=e.headers&&e.headers["content-type"]);if("string"!=typeof t)throw new TypeError("content-type header is missing from object");return t}(e):e;if("string"!=typeof t)throw new TypeError("argument string is required to be a string");var o=t.indexOf(";"),l=-1!==o?t.substr(0,o).trim():t.trim();if(!i.test(l))throw new TypeError("invalid media type");var s=new a(l.toLowerCase());if(-1!==o){var u,c,f;for(r.lastIndex=o;c=r.exec(t);){if(c.index!==o)throw new TypeError("invalid parameter format");o+=c[0].length,u=c[1].toLowerCase(),'"'===(f=c[2])[0]&&(f=f.substr(1,f.length-2).replace(n,"$1")),s.parameters[u]=f}if(o!==t.length)throw new TypeError("invalid parameter format")}return s};function a(e){this.parameters=Object.create(null),this.type=e}var l=function(){return"file:"===window.location.protocol},s=function(e,t){var r=new XMLHttpRequest;r.onreadystatechange=function(){try{if(!/\.svg/i.test(e)&&2===r.readyState){var n=r.getResponseHeader("Content-Type");if(!n)throw new Error("Content type not found");var i=o(n).type;if("image/svg+xml"!==i&&"text/plain"!==i)throw new Error("Invalid content type: "+i)}if(4===r.readyState){if(404===r.status||null===r.responseXML)throw new Error(l()?"Note: SVG injection ajax calls do not work locally without adjusting security settings in your browser. Or consider using a local webserver.":"Unable to load SVG file: "+e);if(!(200===r.status||l()&&0===r.status))throw new Error("There was a problem injecting the SVG: "+r.status+" "+r.statusText);t(null,r)}}catch(e){r.abort(),t(e,r)}},r.open("GET",e),r.overrideMimeType&&r.overrideMimeType("text/xml"),r.send()},u=new Map,c={},f=function(e,t){c[e]=c[e]||[],c[e].push(t)},d=function(e,r){if(u.has(e)){var n=u.get(e);return n instanceof SVGElement?void r(null,t(n)):n instanceof Error?void r(n):void f(e,r)}u.set(e,void 0),f(e,r),s(e,(function(r,n){r?u.set(e,r):n.responseXML instanceof Document&&n.responseXML.documentElement&&n.responseXML.documentElement instanceof SVGElement&&u.set(e,n.responseXML.documentElement),function(e){for(var r=function(r,n){setTimeout((function(){if(Array.isArray(c[e])){var n=u.get(e),i=c[e][r];n instanceof SVGElement&&i(null,t(n)),n instanceof Error&&i(n),r===c[e].length-1&&delete c[e]}}),0)},n=0,i=c[e].length;n<i;n++)r(n)}(e)}))},p=function(e,t){s(e,(function(e,r){e?t(e):r.responseXML instanceof Document&&r.responseXML.documentElement&&r.responseXML.documentElement instanceof SVGElement&&t(null,r.responseXML.documentElement)}))},h=0,v=[],g={},m="http://www.w3.org/1999/xlink",y=function(e,t,r,n,i,o){var a=e.getAttribute("data-src")||e.getAttribute("src");if(a){if(-1!==v.indexOf(e))return v.splice(v.indexOf(e),1),void(e=null);v.push(e),e.setAttribute("src",""),(n?d:p)(a,(function(n,l){if(!l)return v.splice(v.indexOf(e),1),e=null,void o(n);var s=e.getAttribute("id");s&&l.setAttribute("id",s);var u=e.getAttribute("title");u&&l.setAttribute("title",u);var c=e.getAttribute("width");c&&l.setAttribute("width",c);var f=e.getAttribute("height");f&&l.setAttribute("height",f);var d=Array.from(new Set(function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,l=o.length;a<l;a++,i++)n[i]=o[a];return n}((l.getAttribute("class")||"").split(" "),["injected-svg"],(e.getAttribute("class")||"").split(" ")))).join(" ").trim();l.setAttribute("class",d);var p=e.getAttribute("style");p&&l.setAttribute("style",p),l.setAttribute("data-src",a);var y=[].filter.call(e.attributes,(function(e){return/^data-\w[\w-]*$/.test(e.name)}));if(Array.prototype.forEach.call(y,(function(e){e.name&&e.value&&l.setAttribute(e.name,e.value)})),r){var w,b,A,E,x={clipPath:["clip-path"],"color-profile":["color-profile"],cursor:["cursor"],filter:["filter"],linearGradient:["fill","stroke"],marker:["marker","marker-start","marker-mid","marker-end"],mask:["mask"],path:[],pattern:["fill","stroke"],radialGradient:["fill","stroke"]};Object.keys(x).forEach((function(e){b=x[e];for(var t=function(e,t){var r;E=(A=w[e].id)+"-"+ ++h,Array.prototype.forEach.call(b,(function(e){for(var t=0,n=(r=l.querySelectorAll("["+e+'*="'+A+'"]')).length;t<n;t++){var i=r[t].getAttribute(e);i&&!i.match(new RegExp('url\\("?#'+A+'"?\\)'))||r[t].setAttribute(e,"url(#"+E+")")}}));for(var n=l.querySelectorAll("[*|href]"),i=[],o=0,a=n.length;o<a;o++){var s=n[o].getAttributeNS(m,"href");s&&s.toString()==="#"+w[e].id&&i.push(n[o])}for(var u=0,c=i.length;u<c;u++)i[u].setAttributeNS(m,"href","#"+E);w[e].id=E},r=0,n=(w=l.querySelectorAll(e+"[id]")).length;r<n;r++)t(r)}))}l.removeAttribute("xmlns:a");for(var S,j,T=l.querySelectorAll("script"),k=[],M=0,G=T.length;M<G;M++)(j=T[M].getAttribute("type"))&&"application/ecmascript"!==j&&"application/javascript"!==j&&"text/javascript"!==j||((S=T[M].innerText||T[M].textContent)&&k.push(S),l.removeChild(T[M]));if(k.length>0&&("always"===t||"once"===t&&!g[a])){for(var L=0,X=k.length;L<X;L++)new Function(k[L])(window);g[a]=!0}var q=l.querySelectorAll("style");Array.prototype.forEach.call(q,(function(e){e.textContent+=""})),l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("xmlns:xlink",m),i(l),e.parentNode&&e.parentNode.replaceChild(l,e),v.splice(v.indexOf(e),1),e=null,o(null,l)}))}else o(new Error("Invalid data-src or src attribute"))};e.SVGInjector=function(e,t){var r=void 0===t?{}:t,n=r.afterAll,i=void 0===n?function(){}:n,o=r.afterEach,a=void 0===o?function(){}:o,l=r.beforeEach,s=void 0===l?function(){}:l,u=r.cacheRequests,c=void 0===u||u,f=r.evalScripts,d=void 0===f?"never":f,p=r.renumerateIRIElements,h=void 0===p||p;if(e&&"length"in e)for(var v=0,g=0,m=e.length;g<m;g++)y(e[g],d,h,c,s,(function(t,r){a(t,r),e&&"length"in e&&e.length===++v&&i(v)}));else e?y(e,d,h,c,s,(function(t,r){a(t,r),i(1),e=null})):i(0)},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=svg-injector.umd.production.js.map
