"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("goober"),r=require("react"),a=(e=r)&&"object"==typeof e&&"default"in e?e.default:e;const n={allItemsAreSelected:"All items are selected.",clearSearch:"Clear Search",clearSelected:"Clear Selected",noOptions:"No options",search:"Search",selectAll:"Select All",selectSomeItems:"Select..."},l={value:[],focusSearchOnOpen:!0,hasSelectAll:!0,className:"multi-select",debounceDuration:200,options:[]},o=a.createContext({}),s=({props:e,children:t})=>a.createElement(o.Provider,{value:{t:t=>{var r;return(null==(r=e.overrideStrings)?void 0:r[t])||n[t]},...l,...e}},t),c=()=>a.useContext(o),i=(...e)=>e.join(" ");function d(e,t){const r=e.length,a=t.length,n=[];if(!r||!a)return 0;if(r<a&&([e,t]=[t,e]),-1!==e.indexOf(t))return a+1/r;for(let e=0;e<=r;++e)n[e]=[0];for(let e=0;e<=a;++e)n[0][e]=0;for(let l=1;l<=r;++l)for(let r=1;r<=a;++r)n[l][r]=e[l-1]===t[r-1]?1+n[l-1][r-1]:Math.max(n[l][r-1],n[l-1][r]);return n[r][a]}function u(e,t){if(!e)return"";if(e=e.toUpperCase().replace(/((?=[^\u00E0-\u00FC])\W)|_/g,""),!t)return e;const r=t;return Object.keys(r).reduce((e,t)=>{const a=new RegExp(t,"g");return e.replace(a,r[t])},e)}const m=()=>a.createElement("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"dropdown-search-clear-icon gray"},a.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),p=t.css({"& input,& span":{verticalAlign:"middle",margin:0},span:{display:"inline-block",paddingLeft:"5px"},"&.disabled":{opacity:.5}}),h=({checked:e,option:t,onClick:r,disabled:n})=>a.createElement("div",{className:i(p,"item-renderer",n&&"disabled")},a.createElement("input",{type:"checkbox",onChange:r,checked:e,tabIndex:-1,disabled:n}),a.createElement("span",null,t.label)),f=t.css({boxSizing:"border-box",cursor:"pointer",display:"block",padding:"var(--rmsc-p)",outline:0,"&:hover,&:focus":{background:"var(--rmsc-hover)"},"&.selected":{background:"var(--rmsc-selected)"}}),b=({itemRenderer:e=h,option:t,checked:n,focused:l,tabIndex:o,disabled:s,onSelectionChanged:c,onClick:d})=>{const u=r.useRef();r.useEffect(()=>{p()},[n,l]);const m=()=>{c(!n)},p=()=>{l&&!s&&u&&u.current.focus()};return a.createElement("label",{className:i(f,"select-item",n&&"selected"),role:"option","aria-selected":n,tabIndex:o,ref:u,onKeyDown:e=>{switch(e.which){case 13:case 32:m();break;default:return}e.preventDefault()}},a.createElement(e,{option:t,checked:n,onClick:e=>{m(),d(e)},disabled:s}))},v=t.css({margin:0,paddingLeft:0,li:{listStyle:"none",margin:0}}),g=({options:e,focusIndex:t,onClick:r})=>{const{disabled:n,value:l,onChange:o,ItemRenderer:s}=c();return a.createElement("ul",{className:v},e.map((e,c)=>{const i=c+2;return a.createElement("li",{key:(null==e?void 0:e.key)||c},a.createElement(b,{focused:t===i,tabIndex:i,option:e,onSelectionChanged:t=>{return r=e,void(n||o(t?[...l,r]:l.filter(e=>e.value!==r.value)));var r},checked:!!l.find(t=>t.value===e.value),onClick:e=>r(e,i),itemRenderer:s,disabled:e.disabled||n}))}))};var x;!function(e){e[e.SEARCH=-1]="SEARCH",e[e.NONE=1]="NONE"}(x||(x={}));const E=t.css({width:"100%",position:"relative",borderBottom:"1px solid var(--rmsc-border)",input:{height:"var(--rmsc-h)",padding:"0 var(--rmsc-p)",width:"100%",outline:0,border:0}}),y=t.css({cursor:"pointer",position:"absolute",top:0,right:0,bottom:0,background:"none",border:0,padding:"0 calc(var(--rmsc-p)/2)","[hidden]":{display:"none"}}),k=t.css({padding:"var(--rmsc-p)",textAlign:"center",color:"var(--rmsc-gray)"}),S=()=>{const{t:e,onChange:t,options:n,value:l,filterOptions:o,selectAllLabel:s,ItemRenderer:p,disabled:h,disableSearch:f,focusSearchOnOpen:v,hasSelectAll:S,ClearIcon:w,debounceDuration:C}=c(),N=r.useRef(),[I,R]=r.useState(""),[A,O]=r.useState(n),[D,M]=r.useState(""),[H,L]=r.useState(v&&!f?x.SEARCH:x.NONE),P=r.useCallback(((e,t)=>{let r;return function(...a){clearTimeout(r),r=setTimeout(()=>{e.apply(null,a)},t)}})(e=>M(e),C),[]),T={label:s||e("selectAll"),value:""},B=e=>L(e),K=e=>{let t=H+e;t=Math.max(1,t),t=Math.min(t,n.length+1),L(t)},[j,z]=r.useMemo(()=>{const e=A.filter(e=>!e.disabled);return[e.every(e=>-1!==l.findIndex(t=>t.value===e.value)),0!==e.length]},[A,l]);return r.useEffect(()=>{(async()=>o?await o(n,D):function(e,t,r){if(!t)return e;const a=u(t,void 0);return e.filter(({label:e,value:t})=>null!=e&&null!=t).map(e=>({option:e,score:d(u(e.label,void 0),a)})).filter(e=>e.score>=a.length-2).sort((e,t)=>t.score-e.score).map(e=>e.option)}(n,D))().then(O)},[D,n]),a.createElement("div",{className:"select-panel",role:"listbox",onKeyDown:e=>{switch(e.which){case 38:if(e.altKey)return;K(-1);break;case 40:if(e.altKey)return;K(1);break;default:return}e.stopPropagation(),e.preventDefault()}},!f&&a.createElement("div",{className:E},a.createElement("input",{autoFocus:v,placeholder:e("search"),type:"text","aria-describedby":e("search"),onKeyDown:e=>e.stopPropagation(),onChange:e=>{P(e.target.value),R(e.target.value),L(x.SEARCH)},onFocus:()=>{L(x.SEARCH)},value:I,ref:N}),a.createElement("button",{type:"button",className:i(y,"search-clear-button"),hidden:!I,onClick:()=>{var e;M(""),R(""),null==N||null==(e=N.current)||e.focus()},"aria-label":e("clearSearch")},w||a.createElement(m,null))),S&&z&&a.createElement(b,{focused:1===H,tabIndex:1,checked:j,option:T,onSelectionChanged:e=>{const r=(e=>{const t=A.filter(e=>!e.disabled).map(e=>e.value);if(e){const e=[...l.map(e=>e.value),...t];return A.filter(t=>e.includes(t.value))}return l.filter(e=>!t.includes(e.value))})(e);t(r)},onClick:()=>B(1),itemRenderer:p,disabled:h}),A.length?a.createElement(g,{options:A,focusIndex:H,onClick:(e,t)=>B(t)}):a.createElement("div",{className:i(k,"no-options")},e("noOptions")))},w=({expanded:e})=>a.createElement("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"dropdown-heading-dropdown-arrow gray"},a.createElement("path",{d:e?"M18 15 12 9 6 15":"M6 9L12 15 18 9"})),C=()=>{const{t:e,value:t,options:r,valueRenderer:n}=c(),l=0===t.length,o=t.length===r.length,s=n&&n(t,r);return l?a.createElement("span",{className:"gray"},s||e("selectSomeItems")):a.createElement("span",null,s||(o?e("allItemsAreSelected"):t.map(e=>e.label).join(", ")))},N=t.css({animation:"rotate 2s linear infinite","& .path":{stroke:"var(--rmsc-border)",strokeWidth:"4px",strokeLinecap:"round",animation:"dash 1.5s ease-in-out infinite"},"@keyframes rotate":{"100%":{transform:"rotate(360deg)"}},"@keyframes dash":{"0%":{strokeDasharray:"1,150",strokeDashoffset:0},"50%":{strokeDasharray:"90,150",strokeDashoffset:"-35"},"100%":{strokeDasharray:"90,150",strokeDashoffset:"-124"}}}),I=({size:e=24})=>a.createElement("span",{style:{width:e,marginRight:"0.2rem"}},a.createElement("svg",{width:e,height:e,className:N,viewBox:"0 0 50 50",style:{display:"inline",verticalAlign:"middle"}},a.createElement("circle",{cx:"25",cy:"25",r:"20",fill:"none",className:"path"}))),R=t.css({position:"absolute",zIndex:1,top:"100%",width:"100%",paddingTop:"8px",".panel-content":{maxHeight:"300px",overflowY:"auto",borderRadius:"var(--rmsc-radius)",background:"var(--rmsc-bg)",boxShadow:"0 0 0 1px rgba(0, 0, 0, 0.1), 0 4px 11px rgba(0, 0, 0, 0.1)"}}),A=t.css({position:"relative",outline:0,backgroundColor:"var(--rmsc-bg)",border:"1px solid var(--rmsc-border)",borderRadius:"var(--rmsc-radius)","&:focus-within":{boxShadow:"var(--rmsc-main) 0 0 0 1px",borderColor:"var(--rmsc-main)"}}),O=t.css({position:"relative",padding:"0 var(--rmsc-p)",display:"flex",alignItems:"center",width:"100%",height:"var(--rmsc-h)",cursor:"default",outline:0,".dropdown-heading-value":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1}}),D=t.css({cursor:"pointer",background:"none",border:0,padding:0,display:"flex"}),M=()=>{const{t:e,onMenuToggle:t,ArrowRenderer:n,shouldToggleOnHover:l,isLoading:o,disabled:s,onChange:d,labelledBy:u,value:p,isOpen:h,defaultIsOpen:f,ClearSelectedIcon:b}=c(),[v,g]=r.useState(!0),[x,E]=r.useState(f),[y,k]=r.useState(!1),N=n||w,M=r.useRef();!function(e,a){const n=r.useRef(!1);r.useEffect(()=>{n.current?t&&t(x):n.current=!0},a)}(0,[x]),r.useEffect(()=>{void 0===f&&"boolean"==typeof h&&(g(!1),E(h))},[h]);const H=e=>{v&&l&&E(e)};return a.createElement("div",{tabIndex:0,className:i(A,"dropdown-container"),"aria-labelledby":u,"aria-expanded":x,"aria-readonly":!0,"aria-disabled":s,ref:M,onKeyDown:e=>{var t;if(v)switch(e.which){case 27:case 38:E(!1),null==M||null==(t=M.current)||t.focus();break;case 32:case 13:case 40:E(!0);break;default:return}e.preventDefault()},onFocus:()=>!y&&k(!0),onBlur:e=>{!e.currentTarget.contains(e.relatedTarget)&&v&&(k(!1),E(!1))},onMouseEnter:()=>H(!0),onMouseLeave:()=>H(!1)},a.createElement("div",{className:i(O,"dropdown-heading"),onClick:()=>{v&&E(!o&&!s&&!x)}},a.createElement("div",{className:"dropdown-heading-value"},a.createElement(C,null)),o&&a.createElement(I,null),p.length>0&&a.createElement("button",{type:"button",className:i(D,"clear-selected-button"),onClick:e=>{e.stopPropagation(),d([]),v&&E(!1)},disabled:s,"aria-label":e("clearSelected")},b||a.createElement(m,null)),a.createElement(N,{expanded:x})),x&&a.createElement("div",{className:i(R,"dropdown-content")},a.createElement("div",{className:"panel-content"},a.createElement(S,null))))},H=t.css({"--rmscMain":"#4285f4","--rmscHover":"#f1f3f5","--rmscSelected":"#e2e6ea","--rmscBorder":"#ccc","--rmscGray":"#aaa","--rmscBg":"#fff","--rmscP":"10px","--rmscRadius":"4px","--rmscH":"38px","*":{boxSizing:"border-box",transition:"all 0.2s ease"},".gray":{color:"var(--rmsc-gray)"}});exports.Dropdown=M,exports.SelectItem=b,exports.SelectPanel=S,exports.default=e=>a.createElement(s,{props:e},a.createElement("div",{className:i(H,e.className||"multi-select")},a.createElement(M,null)));
//# sourceMappingURL=react-multi-select-component.cjs.production.min.js.map
