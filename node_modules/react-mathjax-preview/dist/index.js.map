{"mappings":"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","sources":["index.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport DOMPurify from \"dompurify\";\n\nconst baseConfig = {\n  showMathMenu: true,\n  tex2jax: {\n    inlineMath: [\n      [\"$\", \"$\"],\n      [\"\\\\(\", \"\\\\)\"],\n    ],\n  },\n  skipStartupTypeset: true,\n};\n\nconst defaultSanitizeOptions = {\n  USE_PROFILES: {mathMl: true},\n  ADD_ATTR: ['columnalign'],\n}\n\nconst MathJaxPreview = React.forwardRef(({\n  script,\n  config,\n  className,\n  math,\n  id,\n  style,\n  wrapperTag,\n  msDelayDisplay, //milliseconds to delay display of div, 300 is default\n  onDisplay,\n  onLoad,\n  onError,\n  sanitizeOptions,\n}, ref) => {\n  const sanitizedMath = DOMPurify.sanitize(math, {...defaultSanitizeOptions, ...sanitizeOptions});\n  const previewRef = useRef();\n  const [display, setDisplay] = useState(\"none\"); //prevent display during processing\n  const [loadingState, setLoadingState] = useState(\n    window.MathJax ? \"loaded\" : \"loading\"\n  );\n\n  useEffect(() => {\n    let mathjaxScriptTag = document.querySelector(`script[src=\"${script}\"]`);\n    if (!mathjaxScriptTag) {\n      mathjaxScriptTag = document.createElement(\"script\");\n      mathjaxScriptTag.async = true;\n      mathjaxScriptTag.src = script;\n\n      for (const [k, v] of Object.entries(config || {})) {\n        mathjaxScriptTag.setAttribute(k, v);\n      }\n      const node = document.head || document.getElementsByTagName(\"head\")[0];\n      node.appendChild(mathjaxScriptTag);\n    }\n    const onloadHandler = () => {\n      setLoadingState(\"loaded\");\n      window.MathJax.Hub.Config({ ...baseConfig, ...config });\n      onLoad && onLoad();\n    };\n    const onerrorHandler = () => {\n      setLoadingState(\"failed\");\n      onError && onError();\n    };\n\n    mathjaxScriptTag.addEventListener(\"load\", onloadHandler);\n    mathjaxScriptTag.addEventListener(\"error\", onerrorHandler);\n\n    return () => {\n      mathjaxScriptTag.removeEventListener(\"load\", onloadHandler);\n      mathjaxScriptTag.removeEventListener(\"error\", onloadHandler);\n    };\n  }, [setLoadingState, config, baseConfig]);\n\n  useEffect(() => {\n    if (loadingState !== \"loaded\") {\n      return;\n    }\n    previewRef.current.innerHTML = sanitizedMath;\n    window.MathJax.Hub.Queue([\n      \"Typeset\",\n      window.MathJax.Hub,\n      previewRef.current,\n    ]);\n\n    //delay display of div\n    var msDelay;\n    if ( //msDelayDisplay prop is a reasonable number of ms\n      msDelayDisplay !== null &&\n      !isNaN(+msDelayDisplay) &&\n      +msDelayDisplay >= 0 &&\n      +msDelayDisplay < 10000\n    ) {\n      msDelay = +msDelayDisplay;\n    } else {\n      msDelay = 300; // default 300ms delay\n    }\n    const timeout = setTimeout(() => {\n      setDisplay(\"inline\"); //display div after delay, hopefully typeset has finished\n      onDisplay && onDisplay();\n    }, msDelay);\n\n    return () => {\n      setDisplay(\"none\");\n      clearTimeout(timeout);\n    };\n  }, [sanitizedMath, loadingState, previewRef]);\n\n  return React.createElement(\n    wrapperTag,\n    { className, id, style: { display, ...style }, ref },\n    <>\n      {loadingState === \"failed\" && <span>fail loading mathjax lib</span>}\n      {React.createElement(wrapperTag, {\n        className: \"react-mathjax-preview-result\",\n        ref: previewRef,\n      })}\n    </>\n  );\n});\n\nMathJaxPreview.displayName = 'MathJaxPreview';\n\nMathJaxPreview.propTypes = {\n  script: PropTypes.string,\n  config: PropTypes.object,\n  className: PropTypes.string,\n  math: PropTypes.string,\n  style: PropTypes.object,\n  wrapperTag: PropTypes.string,\n  id: PropTypes.string,\n  onLoad: PropTypes.func,\n  onError: PropTypes.func,\n  onDisplay: PropTypes.func,\n  sanitizeOptions: PropTypes.object,\n};\n\nMathJaxPreview.defaultProps = {\n  script:\n    \"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-MML-AM_HTMLorMML\",\n  id: \"react-mathjax-preview\",\n  sanitizeOptions: {},\n  wrapperTag: \"div\",\n};\n\nexport default MathJaxPreview;\n"],"names":[],"version":3,"file":"index.js.map"}