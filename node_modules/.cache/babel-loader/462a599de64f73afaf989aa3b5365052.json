{"ast":null,"code":"import _objectSpread from \"C:\\\\laragon\\\\www\\\\Archive\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport { persistReducer } from \"redux-persist\";\nimport storage from \"redux-persist/lib/storage\";\nimport { put, takeLatest } from \"redux-saga/effects\";\nimport { getUserByToken } from \"../../crud/auth.crud\";\nimport * as routerHelpers from \"../../router/RouterHelpers\";\nimport { Auth } from \"aws-amplify\";\nexport var actionTypes = {\n  Login: \"[Login] Action\",\n  Logout: \"[Logout] Action\",\n  Register: \"[Register] Action\",\n  UserRequested: \"[Request User] Action\",\n  UserLoaded: \"[Load User] Auth API\",\n  ForgotPassword: \"[ForgotPassword] Action\",\n  ConfirmForgotPassword: \"[ConfirmForgotPassword] Action\"\n};\nvar initialAuthState = {\n  user: undefined,\n  authToken: undefined,\n  userRole: undefined,\n  sessionExpiredAt: 0\n};\nexport var reducer = persistReducer({\n  storage: storage,\n  key: \"vietlook-auth\",\n  whitelist: [\"user\", \"authToken\", \"userRole\", \"sessionExpiredAt\"]\n}, function () {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialAuthState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case actionTypes.Login:\n      {\n        var authToken = action.payload.authToken;\n        return {\n          authToken: authToken,\n          user: undefined,\n          userRole: undefined\n        };\n      }\n\n    case actionTypes.ForgotPassword:\n      {\n        var _authToken = action.payload.authToken;\n        return {\n          authToken: _authToken,\n          user: undefined,\n          userRole: undefined\n        };\n      }\n\n    case actionTypes.ConfirmForgotPassword:\n      {\n        var _authToken2 = action.payload.authToken;\n        return {\n          authToken: _authToken2,\n          user: undefined,\n          userRole: undefined\n        };\n      }\n\n    case actionTypes.Register:\n      {\n        var _authToken3 = action.payload.authToken;\n        return {\n          authToken: _authToken3,\n          user: undefined,\n          userRole: undefined\n        };\n      }\n\n    case actionTypes.Logout:\n      {\n        routerHelpers.forgotLastLocation();\n        return initialAuthState;\n      }\n\n    case actionTypes.UserLoaded:\n      {\n        var _action$payload = action.payload,\n            user = _action$payload.user,\n            userRole = _action$payload.userRole,\n            sessionExpiredAt = _action$payload.sessionExpiredAt;\n        return _objectSpread(_objectSpread({}, state), {}, {\n          user: user,\n          userRole: userRole,\n          sessionExpiredAt: sessionExpiredAt\n        });\n      }\n\n    default:\n      return _objectSpread({}, state);\n  }\n});\nexport var actions = {\n  login: function login(authToken) {\n    return {\n      type: actionTypes.Login,\n      payload: {\n        authToken: authToken\n      }\n    };\n  },\n  register: function register(authToken) {\n    return {\n      type: actionTypes.Register,\n      payload: {\n        authToken: authToken\n      }\n    };\n  },\n  logout: function logout() {\n    console.log(\"User\", \"logout\");\n    Auth.signOut().then();\n    return {\n      type: actionTypes.Logout\n    };\n  },\n  requestUser: function requestUser(user) {\n    return {\n      type: actionTypes.UserRequested,\n      payload: {\n        user: user\n      }\n    };\n  },\n  fulfillUser: function fulfillUser(user, userRole) {\n    var sessionExpiredAt = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    return {\n      type: actionTypes.UserLoaded,\n      payload: {\n        user: user,\n        userRole: userRole,\n        sessionExpiredAt: sessionExpiredAt\n      }\n    };\n  }\n}; // export function* saga() {\n//   yield takeLatest(actionTypes.Login, function* loginSaga(data) {\n//     yield put(actions.requestUser(data.payload.authToken));\n//   });\n//\n//   yield takeLatest(actionTypes.Register, function* registerSaga() {\n//     yield put(actions.requestUser());\n//   });\n//\n//   yield takeLatest(actionTypes.UserRequested, function* userRequested(data) {\n//     const { data: admin } = yield getUserByToken(data.payload.admin);\n//     if (admin.signal) {\n//       yield put(actions.fulfillUser(admin.data));\n//     } else {\n//       yield put(actions.logout());\n//     }\n//   });\n// }","map":{"version":3,"names":["persistReducer","storage","put","takeLatest","getUserByToken","routerHelpers","Auth","actionTypes","Login","Logout","Register","UserRequested","UserLoaded","ForgotPassword","ConfirmForgotPassword","initialAuthState","user","undefined","authToken","userRole","sessionExpiredAt","reducer","key","whitelist","state","action","type","payload","forgotLastLocation","actions","login","register","logout","console","log","signOut","then","requestUser","fulfillUser"],"sources":["C:/laragon/www/Archive/src/app/store/ducks/auth.duck.js"],"sourcesContent":["import { persistReducer } from \"redux-persist\";\nimport storage from \"redux-persist/lib/storage\";\nimport { put, takeLatest } from \"redux-saga/effects\";\nimport { getUserByToken } from \"../../crud/auth.crud\";\nimport * as routerHelpers from \"../../router/RouterHelpers\";\nimport { Auth } from \"aws-amplify\";\n\nexport const actionTypes = {\n  Login: \"[Login] Action\",\n  Logout: \"[Logout] Action\",\n  Register: \"[Register] Action\",\n  UserRequested: \"[Request User] Action\",\n  UserLoaded: \"[Load User] Auth API\",\n  ForgotPassword: \"[ForgotPassword] Action\",\n  ConfirmForgotPassword: \"[ConfirmForgotPassword] Action\",\n};\n\nconst initialAuthState = {\n  user: undefined,\n  authToken: undefined,\n  userRole: undefined,\n  sessionExpiredAt: 0,\n};\n\nexport const reducer = persistReducer(\n  {\n    storage,\n    key: \"vietlook-auth\",\n    whitelist: [\"user\", \"authToken\", \"userRole\", \"sessionExpiredAt\"],\n  },\n  (state = initialAuthState, action) => {\n    switch (action.type) {\n      case actionTypes.Login: {\n        const { authToken } = action.payload;\n\n        return { authToken, user: undefined, userRole: undefined };\n      }\n\n      case actionTypes.ForgotPassword: {\n        const { authToken } = action.payload;\n\n        return { authToken, user: undefined, userRole: undefined };\n      }\n\n      case actionTypes.ConfirmForgotPassword: {\n        const { authToken } = action.payload;\n\n        return { authToken, user: undefined, userRole: undefined };\n      }\n\n      case actionTypes.Register: {\n        const { authToken } = action.payload;\n\n        return { authToken, user: undefined, userRole: undefined };\n      }\n\n      case actionTypes.Logout: {\n        routerHelpers.forgotLastLocation();\n        return initialAuthState;\n      }\n\n      case actionTypes.UserLoaded: {\n        const { user, userRole, sessionExpiredAt } = action.payload;\n        return { ...state, user, userRole, sessionExpiredAt };\n      }\n\n      default:\n        return { ...state };\n    }\n  },\n);\n\nexport const actions = {\n  login: (authToken) => ({ type: actionTypes.Login, payload: { authToken } }),\n  register: (authToken) => ({\n    type: actionTypes.Register,\n    payload: { authToken },\n  }),\n  logout: () => {\n    console.log(\"User\", \"logout\");\n    Auth.signOut().then();\n    return { type: actionTypes.Logout };\n  },\n  requestUser: (user) => ({\n    type: actionTypes.UserRequested,\n    payload: { user },\n  }),\n  fulfillUser: (user, userRole, sessionExpiredAt = 0) => ({\n    type: actionTypes.UserLoaded,\n    payload: { user, userRole, sessionExpiredAt },\n  }),\n};\n\n// export function* saga() {\n//   yield takeLatest(actionTypes.Login, function* loginSaga(data) {\n//     yield put(actions.requestUser(data.payload.authToken));\n//   });\n//\n//   yield takeLatest(actionTypes.Register, function* registerSaga() {\n//     yield put(actions.requestUser());\n//   });\n//\n//   yield takeLatest(actionTypes.UserRequested, function* userRequested(data) {\n//     const { data: admin } = yield getUserByToken(data.payload.admin);\n//     if (admin.signal) {\n//       yield put(actions.fulfillUser(admin.data));\n//     } else {\n//       yield put(actions.logout());\n//     }\n//   });\n// }\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}